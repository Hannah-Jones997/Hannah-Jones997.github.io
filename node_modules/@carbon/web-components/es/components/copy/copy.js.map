{"version":3,"file":"copy.js","sources":["../../../src/components/copy/copy.ts"],"sourcesContent":["/**\n * Copyright IBM Corp. 2019, 2024\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { prefix } from '../../globals/settings';\nimport styles from '../copy-button/copy-button.scss?lit';\nimport CDSIconButton from '../icon-button/icon-button';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\n\n/**\n * Copy.\n *\n * @element cds-copy\n */\n@customElement(`${prefix}-copy`)\nclass CDSCopy extends CDSIconButton {\n  /**\n   * `true` to show the feedback tooltip.\n   */\n  private _showFeedback = false;\n\n  /**\n   * `true` to show the feedback tooltip.\n   */\n  private _animation = '';\n\n  private _createHandleFeedbackTooltip = () => {\n    let timeoutId: number | void;\n    return (timeout: number) => {\n      const buttonClasses = this.shadowRoot?.querySelector('button')?.classList;\n\n      if (timeoutId) {\n        clearTimeout(timeoutId);\n        timeoutId = undefined;\n      }\n      this._showFeedback = true;\n      buttonClasses?.add(`${prefix}--copy-btn--animating`);\n      this._animation = 'fade-in';\n      buttonClasses?.add(`${prefix}--copy-btn--${this._animation}`);\n      this.requestUpdate();\n      timeoutId = setTimeout(() => {\n        this._showFeedback = false;\n        this._animation = 'fade-out';\n        buttonClasses?.remove(`${prefix}--copy-btn--fade-in`);\n        buttonClasses?.add(`${prefix}--copy-btn--${this._animation}`);\n        this.requestUpdate();\n      }, timeout) as unknown as number;\n    };\n  };\n\n  /**\n   * Handles showing/hiding the feedback tooltip.\n   */\n  private _handleFeedbackTooltip = this._createHandleFeedbackTooltip();\n\n  /**\n   * Handles `click` event on the copy button.\n   */\n  private _handleClickButton() {\n    this._handleFeedbackTooltip(this.feedbackTimeout);\n  }\n\n  /**\n   * Specify the string that is displayed when the button is clicked and the content is copi\n   */\n  @property()\n  feedback = 'Copied!';\n\n  /**\n   * The number in milliseconds to determine how long the tooltip should remain.\n   */\n  @property({ type: Number, attribute: 'feedback-timeout' })\n  feedbackTimeout = 2000;\n\n  // eslint-disable-next-line class-methods-use-this\n  protected _renderTooltipContent() {\n    return html`\n      <cds-tooltip-content>\n        ${this._showFeedback\n          ? this.feedback\n          : html`<slot name=\"tooltip-content\"></slot>`}\n      </cds-tooltip-content>\n    `;\n  }\n\n  connectedCallback() {\n    this.closeOnActivation = false;\n\n    this.addEventListener('click', this._handleClickButton);\n\n    super.connectedCallback();\n  }\n\n  updated(changedProperties) {\n    this.shadowRoot\n      ?.querySelector('button')\n      ?.addEventListener('animationend', () => {\n        if (this._animation === 'fade-out') {\n          const buttonClasses =\n            this.shadowRoot?.querySelector('button')?.classList;\n          buttonClasses?.remove(`${prefix}--copy-btn--animating`);\n          buttonClasses?.remove(`${prefix}--copy-btn--${this._animation}`);\n          this._animation = '';\n        }\n      });\n\n    super.updated(changedProperties);\n\n    this.shadowRoot\n      ?.querySelector('button') // @ts-ignore: TS thinks `host` doesn't exist on `parentNode`\n      ?.setAttribute('aria-label', this.parentNode?.host.textContent);\n  }\n\n  static styles = styles;\n}\n\nexport default CDSCopy;\n"],"names":["customElement"],"mappings":"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"}