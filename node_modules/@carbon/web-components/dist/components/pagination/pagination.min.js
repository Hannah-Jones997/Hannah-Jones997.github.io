/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as t}from"../../node_modules/tslib/tslib.es6.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{html as e}from"../../node_modules/lit-html/lit-html.min.js";import{LitElement as a}from"../../node_modules/lit-element/lit-element.min.js";import{property as i}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{query as s}from"../../node_modules/@lit/reactive-element/decorators/query.min.js";import o from"../../packages/icons/lib/caret--left/16.min.js";import n from"../../packages/icons/lib/caret--right/16.min.js";import{prefix as r}from"../../globals/settings.min.js";import l from"../../globals/mixins/focus.min.js";import p from"../../globals/mixins/host-listener.min.js";import c from"../../globals/decorators/host-listener.min.js";import d from"./pagination.scss.min.js";import{PAGINATION_SIZE as g}from"./defs.min.js";import"../button/button.min.js";import"../button/button-set.min.js";import"../button/button-skeleton.min.js";import{carbonElement as u}from"../../globals/decorators/carbon-element.min.js";let m=class extends(l(p(a))){constructor(){super(...arguments),this.backwardText="Previous page",this.page=1,this.formatLabelText=({count:t})=>`Page number, of ${t} page${t<=1?"":"s"}`,this.formatStatusWithDeterminateTotal=({start:t,end:e,count:a})=>`${t}–${e} of ${a} item${a<=1?"":"s"}`,this.formatStatusWithIndeterminateTotal=({start:t,end:e,count:a})=>null==e?`Item ${t}–`:`${t}–${e} item${a<=1?"":"s"}`,this.formatSupplementalText=({count:t})=>this.pagesUnknown||!this.totalItems?"page":`of ${t} page${t<=1?"":"s"}`,this.itemsPerPageText="Items per page:",this.disabled=!1,this.forwardText="Next page",this.pageInputDisabled=!1,this.pageSize=10,this.pagesUnknown=!1,this.size=g.MEDIUM,this.start=0,this.totalPages=1}_handleSlotChange({target:t}){t.assignedNodes().filter((t=>t.nodeType!==Node.TEXT_NODE||t.textContent.trim())).forEach((t=>{this._pageSizeSelect.appendChild(t)}))}_renderStatusText(){const{start:t,pageSize:e,totalItems:a,pagesUnknown:i,formatStatusWithDeterminateTotal:s,formatStatusWithIndeterminateTotal:o}=this;return(null==a||i?o:s)({start:t+1,end:Math.min(t+e,null==a?1/0:a),count:a})}_handleUserInitiatedChangeStart(t){this.start=t,this.dispatchEvent(new CustomEvent(this.constructor.eventChangeCurrent,{bubbles:!0,composed:!0,detail:{page:this.page,pageSize:this.pageSize}}))}_handleUserInitiatedPageSizeChange(){this.dispatchEvent(new CustomEvent(this.constructor.eventPageSizeChanged,{bubbles:!0,composed:!0,detail:{page:this.page,pageSize:this.pageSize}}))}_handleClickPrevButton(){var t;const{start:e,pageSize:a}=this;this.page--;const i=Math.max(e-a,0);if(i!==e&&this._handleUserInitiatedChangeStart(i),1===this.page){const{selectorForwardButton:e}=this.constructor;(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(`[button-class-name*=${e}]`)).focus()}}_handleClickNextButton(){var t;const{start:e,pageSize:a,totalItems:i}=this;this.page++;const s=e+a;if(s<(null==i?1/0:i)&&this._handleUserInitiatedChangeStart(s),this.page===this.totalPages){const{selectorPreviousButton:e}=this.constructor;(null===(t=this.shadowRoot)||void 0===t?void 0:t.querySelector(`[button-class-name*=${e}]`)).focus()}}_handleChangeSelector(t){const{value:e}=t.detail,{totalItems:a,pageSize:i}=this;t.composedPath()[0]===this._pageSizeSelect?(this.pageSize=parseInt(e),this.totalPages=i>0?Math.ceil(a/i):a,this.page=1,this.start=0,this._handleUserInitiatedPageSizeChange()):(this.page=e,this._handleUserInitiatedChangeStart((e-1)*i))}updated(t){const{page:e,pageSize:a,totalItems:i}=this,{selectorPageSizesSelect:s,selectorPagesSelect:o}=this.constructor;t.has("pageSize")&&(this.shadowRoot.querySelector(s).value=a),(t.has("pageSize")||t.has("start"))&&(this.totalPages=a>0?Math.ceil(i/a):i,this.shadowRoot.querySelector(o).value=this.page.toString()),t.has("page")&&this._handleUserInitiatedChangeStart((e-1)*a)}render(){const{page:t,disabled:a,forwardText:i,backwardText:s,itemsPerPageText:l,pageInputDisabled:p,pageSize:c,pageSizeInputDisabled:d,pagesUnknown:g,size:u,start:m,totalItems:h,totalPages:b,_handleClickPrevButton:$,_handleClickNextButton:_,_handleSlotChange:S,formatLabelText:v,formatSupplementalText:f}=this,{isLastPage:y=m+c>=h}=this,x=a||0===m,z=a||y,w={[`${r}--btn`]:!0,[`${r}--btn--icon-only`]:!0,[`${r}--pagination__button`]:!0,[`${r}--pagination__button--backward`]:!0,[`${r}--pagination__button--no-index`]:x,[`${r}--btn--${u}`]:!0,[`${r}--btn--ghost`]:!0},P={[`${r}--btn`]:!0,[`${r}--btn--icon-only`]:!0,[`${r}--pagination__button`]:!0,[`${r}--pagination__button--forward`]:!0,[`${r}--pagination__button--no-index`]:z,[`${r}--btn--${u}`]:!0,[`${r}--btn--ghost`]:!0},T=Object.entries(w).filter((([,t])=>!0===t)).map((([t])=>t)).join(" "),I=Object.entries(P).filter((([,t])=>!0===t)).map((([t])=>t)).join(" ");return e`
      <div class="${r}--pagination__left">
        <label for="select" class="${r}--pagination__text"
          ><slot name="label-text">${l}</slot></label
        >
        <cds-select
          ?disabled=${a||d}
          id="page-size-select"
          left-select
          pagination
          size="${u}"
          inline
          value="${c}">
          <slot @slotchange=${S}></slot>
        </cds-select>
        <span
          class="${r}--pagination__text ${r}--pagination__items-count"
          >${this._renderStatusText()}</span
        >
      </div>
      <div class="${r}--pagination__right">
        <label for="select" class="${r}--label ${r}--visually-hidden">
          ${v({count:b})}
        </label>
        ${g||!h?e`
              <span
                class="${r}--pagination__text ${r}--pagination__page-text"
                >${f({count:b})}</span
              >

              <cds-select
                ?disabled=${a||p}
                id="pages-select"
                pagination
                size="${u}"
                inline
                value="${t}">
                ${Array.from(new Array(b)).map(((t,a)=>e`
                    <cds-select-item value="${a+1}">
                      ${a+1}
                    </cds-select-item>
                  `))}
              </cds-select>
            `:e`
              <cds-select
                ?disabled=${a||p}
                id="pages-select"
                pagination
                size="${u}"
                inline
                value="${t}">
                ${Array.from(new Array(b)).map(((t,a)=>e`
                    <cds-select-item value="${a+1}">
                      ${a+1}
                    </cds-select-item>
                  `))}
              </cds-select>
              <span class="${r}--pagination__text"
                >${f({count:b})}</span
              >
            `}

        <div class="${r}--pagination__control-buttons">
          <cds-button
            pagination
            size="${u}"
            ?disabled="${x}"
            button-class-name="${T}"
            tooltip-text="${s}"
            @click="${$}">
            ${o({slot:"icon"})}
          </cds-button>
          <cds-button
            tooltip-position="top-right"
            pagination
            size="${u}"
            ?disabled="${z}"
            button-class-name="${I}"
            tooltip-text="${i}"
            @click="${_}">
            ${n({slot:"icon"})}
          </cds-button>
        </div>
      </div>
    `}static get selectorPagesSelect(){return`${r}-select#pages-select`}static get selectorPageSizesSelect(){return`${r}-select`}static get selectorPreviousButton(){return`${r}--pagination__button--backward`}static get selectorForwardButton(){return`${r}--pagination__button--forward`}static get eventChangeCurrent(){return`${r}-pagination-changed-current`}static get eventPageSizeChanged(){return`${r}-page-sizes-select-changed`}};m.shadowRootOptions=Object.assign(Object.assign({},a.shadowRootOptions),{delegatesFocus:!0}),m.styles=d,t([s(`${r}-select`)],m.prototype,"_pageSizeSelect",void 0),t([c(`${r}-select-selected`)],m.prototype,"_handleChangeSelector",null),t([i({attribute:"backward-text"})],m.prototype,"backwardText",void 0),t([i({type:Number,reflect:!0})],m.prototype,"page",void 0),t([i({attribute:!1})],m.prototype,"formatLabelText",void 0),t([i({attribute:!1})],m.prototype,"formatStatusWithDeterminateTotal",void 0),t([i({attribute:!1})],m.prototype,"formatStatusWithIndeterminateTotal",void 0),t([i({attribute:!1})],m.prototype,"formatSupplementalText",void 0),t([i({type:Boolean,attribute:"is-last-page"})],m.prototype,"isLastPage",void 0),t([i({attribute:"items-per-page-text"})],m.prototype,"itemsPerPageText",void 0),t([i({type:Boolean,reflect:!0})],m.prototype,"disabled",void 0),t([i({attribute:"forward-text"})],m.prototype,"forwardText",void 0),t([i({type:Boolean,attribute:"page-input-disabled"})],m.prototype,"pageInputDisabled",void 0),t([i({type:Number,attribute:"page-size",reflect:!0})],m.prototype,"pageSize",void 0),t([i({type:Boolean,attribute:"page-size-input-disabled"})],m.prototype,"pageSizeInputDisabled",void 0),t([i({attribute:"page-size-label-text"})],m.prototype,"pageSizeLabelText",void 0),t([i({type:Boolean,reflect:!0,attribute:"pages-unknown"})],m.prototype,"pagesUnknown",void 0),t([i({reflect:!0})],m.prototype,"size",void 0),t([i({type:Number})],m.prototype,"start",void 0),t([i({type:Number,attribute:"total-items"})],m.prototype,"totalItems",void 0),t([i({type:Number})],m.prototype,"totalPages",void 0),m=t([u(`${r}-pagination`)],m);
