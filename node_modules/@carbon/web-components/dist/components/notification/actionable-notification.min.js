/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as t}from"../../node_modules/tslib/tslib.es6.min.js";import o from"../../packages/icons/lib/checkmark--filled/20.min.js";import e from"../../packages/icons/lib/error--filled/20.min.js";import i from"../../packages/icons/lib/information--filled/20.min.js";import n from"../../packages/icons/lib/information--square--filled/20.min.js";import s from"../../packages/icons/lib/warning--filled/20.min.js";import l from"../../packages/icons/lib/warning--alt--filled/20.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{svg as r,html as a}from"../../node_modules/lit-html/lit-html.min.js";import"../../node_modules/lit-element/lit-element.min.js";import{property as c}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{query as d}from"../../node_modules/@lit/reactive-element/decorators/query.min.js";import{prefix as u,selectorTabbable as m}from"../../globals/settings.min.js";import{carbonElement as h}from"../../globals/decorators/carbon-element.min.js";import{NOTIFICATION_KIND as p,NOTIFICATION_TYPE as f}from"./defs.min.js";import v from"./inline-notification.min.js";import _ from"./actionable-notification.scss.min.js";import b from"../../globals/decorators/host-listener.min.js";import y from"../../globals/mixins/host-listener.min.js";var N;const g={[p.SUCCESS]:o,[p.INFO]:i,[p.INFO_SQUARE]:n,[p.WARNING]:s,[p.WARNING_ALT]:l,[p.ERROR]:e},O=Node.DOCUMENT_POSITION_PRECEDING|Node.DOCUMENT_POSITION_CONTAINS,$=Node.DOCUMENT_POSITION_FOLLOWING|Node.DOCUMENT_POSITION_CONTAINED_BY;function j(t,o=!1){var e,i;if(o)for(let o=t.length-1;o>=0;--o){const e=t[o];e.focus();const n=e.ownerDocument.activeElement;if(n===e||(null==n?void 0:n.contains(e))||(null===(i=null==n?void 0:n.shadowRoot)||void 0===i?void 0:i.contains(e)))return!0}else for(let o=0;o<t.length;++o){const i=t[o];i.focus();const n=i.ownerDocument.activeElement;if(n===i||(null==n?void 0:n.contains(i))||(null===(e=null==n?void 0:n.shadowRoot)||void 0===e?void 0:e.contains(i)))return!0}return!1}let w=N=class extends(y(v)){constructor(){super(...arguments),this._type=f.ACTIONABLE,this.inline=!1,this.actionButtonLabel="",this.closeOnEscape=!0,this.hasFocus=!0,this._handleKeyDown=async t=>{const{key:o}=t;this.closeOnEscape&&"Escape"===o&&(this.open=!1)},this._handleBlur=async({target:t,relatedTarget:o})=>{var e,i;const{open:n,_startSentinelNode:s,_endSentinelNode:l}=this,r=t!==this&&(this.contains(t)||(null===(e=this.shadowRoot)||void 0===e?void 0:e.contains(t))&&t!==s&&t!==l),a=o!==this&&(this.contains(o)||(null===(i=this.shadowRoot)||void 0===i?void 0:i.contains(o))&&o!==s&&o!==l),{selectorTabbable:c}=this.constructor;if(n&&"alertdialog"===this.getAttribute("role")&&o&&!(o instanceof N)&&r&&!a){const e=t.compareDocumentPosition(o),i=this.shadowRoot.querySelectorAll(c),n=this.querySelectorAll(c);o===s||e&O?(await this.constructor._delay(),j(i,!0)||j(n,!0)||o===this||this.focus()):(o===l||e&$)&&(await this.constructor._delay(),j(n)||j(i)||this.focus())}},this.caption=""}connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","alertdialog"),super.connectedCallback()}_renderIcon(){const{statusIconDescription:t,kind:o,inline:e}=this,{[o]:i}=g;return i?i({class:`${u}--${e?"inline":"toast"}-notification__icon`,children:t?r`<title>${t}</title>`:void 0}):void 0}_renderText(){const{subtitle:t,title:o,_type:e}=this;return a`
      <div class="${u}--${e}-notification__text-wrapper">
        <div class="${u}--${e}-notification__content">
          <div class="${u}--${e}-notification__title">
            ${o}<slot name="title"></slot>
          </div>
          <div class="${u}--${e}-notification__subtitle">
            ${t}<slot name="subtitle"></slot>
          </div>
          <slot></slot>
        </div>
      </div>
    `}updated(t){super.updated(t);const o=this.querySelector(this.constructor.selectorActionButton);t.has("inline")&&(null==o||o.setAttribute("kind",this.inline?"ghost":"tertiary")),t.has("lowContrast")&&(this.lowContrast?null==o||o.setAttribute("low-contrast","true"):null==o||o.removeAttribute("low-contrast")),t.has("hideCloseButton")&&(this.hideCloseButton?null==o||o.setAttribute("hide-close-button","true"):null==o||o.removeAttribute("hide-close-button")),t.has("hasFocus")&&this.hasFocus&&this.focus()}render(){const{_type:t}=this;return a`
      <a
        id="start-sentinel"
        class="${u}--visually-hidden"
        href="javascript:void 0"
        role="navigation"></a>
      <div class="${u}--${t}-notification__details">
        ${this._renderIcon()} ${this._renderText()}
      </div>
      <slot name="action"></slot>
      ${this._renderButton()}
      <a
        id="end-sentinel"
        class="${u}--visually-hidden"
        href="javascript:void 0"
        role="navigation"></a>
    `}static _delay(t=0){return new Promise((o=>{setTimeout(o,t)}))}static get selectorTabbable(){return m}static get selectorActionButton(){return`${u}-actionable-notification-button`}};w.styles=_,t([c({type:Boolean,reflect:!0})],w.prototype,"inline",void 0),t([c({type:String,reflect:!0,attribute:"action-button-label"})],w.prototype,"actionButtonLabel",void 0),t([c({type:Boolean,reflect:!0,attribute:"close-on-escape"})],w.prototype,"closeOnEscape",void 0),t([c({type:Boolean,reflect:!0,attribute:"has-focus"})],w.prototype,"hasFocus",void 0),t([d("#start-sentinel")],w.prototype,"_startSentinelNode",void 0),t([d("#end-sentinel")],w.prototype,"_endSentinelNode",void 0),t([b("keydown")],w.prototype,"_handleKeyDown",void 0),t([b("shadowRoot:focusout")],w.prototype,"_handleBlur",void 0),t([c()],w.prototype,"caption",void 0),w=N=t([h(`${u}-actionable-notification`)],w);
