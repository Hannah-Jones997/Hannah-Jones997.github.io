/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as e}from"../../node_modules/tslib/tslib.es6.min.js";import{classMap as t}from"../../node_modules/lit-html/directives/class-map.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{html as r}from"../../node_modules/lit-html/lit-html.min.js";import{LitElement as i}from"../../node_modules/lit-element/lit-element.min.js";import{property as o}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{prefix as s}from"../../globals/settings.min.js";import{TREE_SIZE as l}from"./defs.min.js";import a from"../../globals/decorators/host-listener.min.js";import n from"../../globals/mixins/host-listener.min.js";import d from"./tree-view.scss.min.js";import{carbonElement as c}from"../../globals/decorators/carbon-element.min.js";
/**
 * @license
 *
 * Copyright IBM Corp. 2025, 2025
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */var b;let m=b=class extends(n(i)){constructor(){super(...arguments),this.hideLabel=!1,this.size=l.SMALL,this._click=({target:e})=>{if(e.disabled)return;this.querySelectorAll(b.selectorTreeNode).forEach((t=>{var r;const i=t===e,o=t.hasAttribute("href"),s=o?null===(r=t.shadowRoot)||void 0===r?void 0:r.querySelector("a"):t;t.selected=i,t.active=i,i?s.setAttribute("tabindex","0"):o?s.setAttribute("tabindex","-1"):s.removeAttribute("tabindex")}))},this._handleKeyDown=e=>{const{key:t}=e,r=Array.from(this.querySelectorAll(b.selectorTreeNode)).filter((e=>e.checkVisibility()&&!e.hasAttribute("disabled"))),i=Array.from(this.querySelectorAll(b.selectorTreeNode)).filter((e=>!e.hasAttribute("disabled"))),o=r[0].href,s=r.findIndex((e=>{var t;return o?"0"===(null===(t=e.shadowRoot)||void 0===t?void 0:t.querySelector("a").getAttribute("tabindex")):"0"===e.getAttribute("tabindex")}));let l=s;switch(t){case"ArrowDown":l=Math.min(s+1,r.length-1);break;case"ArrowUp":l=Math.max(s-1,0);break;case"Home":l=0;break;case"End":l=r.length-1;break;case"Enter":case" ":e.preventDefault(),i.forEach((e=>{e.selected=!1,e.active=!1})),r[s].selected=!0,r[s].active=!0;break;case"ArrowRight":r[s].hasAttribute("parent")&&(r[s].isExpanded=!0,r[s].setAttribute("aria-expanded","true"));break;case"ArrowLeft":if(r[s].hasAttribute("parent"))r[s].isExpanded=!1,r[s].setAttribute("aria-expanded","false");else{const e=r.findIndex((e=>e===r[s].parentElement));l=-1===e?s:e}}if(l!==s){r.forEach((e=>{var t;o?null===(t=e.shadowRoot)||void 0===t||t.querySelector("a").setAttribute("tabindex","-1"):e.removeAttribute("tabindex")}));const t=o?r[l].shadowRoot.querySelector("a"):r[l];t.setAttribute("tabindex","0"),t.focus(),e.preventDefault()}}}async _setInitialFocus(){await this.updateComplete;const e=this.querySelectorAll(b.selectorTreeNode);if(e.length>0){const t=Array.from(e).find((e=>e.selected))||e[0];(t.href?t.shadowRoot.querySelector("a"):t).setAttribute("tabindex","0")}}connectedCallback(){super.connectedCallback(),this.hasAttribute("role")||this.setAttribute("role","tree"),this.hasAttribute("aria-label")||this.setAttribute("aria-label",this.label)}updated(e){if(this._setInitialFocus(),e.has("size")){this.querySelectorAll(b.selectorTreeNode).forEach((e=>{e.setAttribute("size",this.size)}))}}render(){const{hideLabel:e,label:i,size:o}=this,l="tree-view__label",a=t({[`${s}--tree`]:!0,[`${s}--tree--${o}`]:o});return r`
      ${e?null:r`<label id=${l} class=${`${s}--label`}
              >${i}
            </label>`}
      <ul
        aria-label=${e?i:void 0}
        aria-labelledby=${e?void 0:l}
        class=${a}
        role="tree">
        <slot><slot>
      </ul>
    `}static get selectorTreeNode(){return`${s}-tree-node`}};m.styles=d,e([o({type:Boolean,attribute:"hide-label"})],m.prototype,"hideLabel",void 0),e([o()],m.prototype,"label",void 0),e([o({reflect:!0})],m.prototype,"size",void 0),e([a("click")],m.prototype,"_click",void 0),e([a("keydown")],m.prototype,"_handleKeyDown",void 0),m=b=e([c(`${s}-tree-view`)],m);export{l as TREE_SIZE};
