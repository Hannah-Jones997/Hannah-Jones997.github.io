/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as e}from"../../node_modules/tslib/tslib.es6.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{html as t}from"../../node_modules/lit-html/lit-html.min.js";import{LitElement as i}from"../../node_modules/lit-element/lit-element.min.js";import{property as l}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{prefix as o}from"../../globals/settings.min.js";import{NAVIGATION_DIRECTION as s}from"../../globals/internal/radio-group-manager.min.js";import r from"../../globals/decorators/host-listener.min.js";import n from"../../globals/mixins/host-listener.min.js";import c from"./tile.scss.min.js";import{carbonElement as a}from"../../globals/decorators/carbon-element.min.js";const d={ArrowUp:s.BACKWARD,Up:s.BACKWARD,ArrowLeft:s.BACKWARD,Left:s.BACKWARD,ArrowDown:s.FORWARD,Down:s.FORWARD,ArrowRight:s.FORWARD,Right:s.FORWARD};let h=class extends(n(i)){constructor(){super(...arguments),this._handleKeydown=e=>{const{target:t,key:i}=e,{radioTiles:l,selectableTiles:s}=this,r=d[i];if(null==t?void 0:t.matches(`${o}-ai-label`))return;const n=l.length?l:s,c=[...n].findIndex((e=>e==t))+r,a=-1!==c?n[c%n.length]:n[n.length-1];r?(e.preventDefault(),this.radioTiles.length?this._handleKeydownRadio(a):this._handleKeydownSelectable(e,a)):" "!==i&&"Enter"!==i||this._handleKeydownSelectable(e)},this._handleFocus=e=>{const{relatedTarget:t,target:i}=e;(null==i?void 0:i.matches(`${o}-ai-label`))||this.radioTiles.length&&(this.currentRadioSelection?(null==t?void 0:t.matches(this.constructor.selectorRadioTile))||i===this.currentRadioSelection||this.currentRadioSelection.focus():(i.toggleAttribute("selected"),this.currentRadioSelection=i))},this.currentSelections=[]}_handleRadioClick(e){const{target:t}=e,{currentRadioSelection:i}=this,{eventCurrentRadioTileSelection:l}=this.constructor;t.matches(`${o}-ai-label`)||(i?i!==t&&(i.toggleAttribute("selected"),this.currentRadioSelection=t):this.currentRadioSelection=t,this.dispatchEvent(new CustomEvent(l,{bubbles:!0,composed:!0,detail:{target:t}})))}_handleTileSelect(e){this.radioTiles.length&&this._handleRadioClick(e)}_handleKeydownRadio(e){const{currentRadioSelection:t}=this,{eventCurrentRadioTileSelection:i}=this.constructor;t&&t.toggleAttribute("selected"),e.focus(),e.toggleAttribute("selected"),this.currentRadioSelection=e,this.dispatchEvent(new CustomEvent(i,{bubbles:!0,composed:!0,detail:{nextSibling:e}}))}_handleKeydownSelectable(e,t){const{target:i}=e,{currentSelections:l}=this,{eventCurrentSelectableTilesSelection:o}=this.constructor;t?t.focus():(l.includes(i)?l.splice(l.indexOf(i),1):l.push(i),this.dispatchEvent(new CustomEvent(o,{bubbles:!0,composed:!0,detail:{currentSelections:l}})))}firstUpdated(){this.hasAttribute("role")||this.setAttribute("role","group"),this.radioTiles||(this.radioTiles=this.querySelectorAll(this.constructor.selectorRadioTile),this.radioTiles.forEach((e=>{e.selected&&(this.currentRadioSelection=e)}))),this.selectableTiles||(this.selectableTiles=this.querySelectorAll(this.constructor.selectorSelectableTile)),this.disabled&&(this.radioTiles.forEach((e=>e.toggleAttribute("disabled"))),this.selectableTiles.forEach((e=>e.toggleAttribute("disabled"))))}render(){const{fieldsetClassName:e,disabled:i}=this;return t`
      <fieldset class="${e}" ?disabled=${i}>
        <slot name="legend" class="${o}--label"></slot>
        <slot></slot>
      </fieldset>
    `}static get selectorRadioTile(){return`${o}-radio-tile`}static get selectorSelectableTile(){return`${o}-selectable-tile`}static get eventCurrentRadioTileSelection(){return`${o}-current-radio-tile-selection`}static get eventCurrentSelectableTilesSelection(){return`${o}-current-selectable-tile-selections`}};h.styles=c,e([r("click")],h.prototype,"_handleTileSelect",null),e([r("keydown")],h.prototype,"_handleKeydown",void 0),e([r("focusin")],h.prototype,"_handleFocus",void 0),e([l({reflect:!0,attribute:"fieldset-class-name"})],h.prototype,"fieldsetClassName",void 0),e([l({reflect:!0,type:Boolean})],h.prototype,"disabled",void 0),e([l()],h.prototype,"currentRadioSelection",void 0),e([l()],h.prototype,"currentSelections",void 0),e([l()],h.prototype,"radioTiles",void 0),e([l()],h.prototype,"selectableTiles",void 0),h=e([a(`${o}-tile-group`)],h);
