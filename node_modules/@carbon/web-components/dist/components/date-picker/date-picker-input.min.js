/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as e}from"../../node_modules/tslib/tslib.es6.min.js";import{classMap as t}from"../../node_modules/lit-html/directives/class-map.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{html as i}from"../../node_modules/lit-html/lit-html.min.js";import{LitElement as o}from"../../node_modules/lit-element/lit-element.min.js";import{property as l}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{state as a}from"../../node_modules/@lit/reactive-element/decorators/state.min.js";import{query as r}from"../../node_modules/@lit/reactive-element/decorators/query.min.js";import s from"../../packages/icons/lib/calendar/16.min.js";import{ifDefined as n}from"../../node_modules/lit-html/directives/if-defined.min.js";import{prefix as d}from"../../globals/settings.min.js";import p from"../../globals/mixins/focus.min.js";import"../text-input/text-input.min.js";import{DATE_PICKER_INPUT_KIND as c}from"./defs.min.js";import m from"../../packages/icons/lib/warning--filled/16.min.js";import h from"../../packages/icons/lib/warning--alt--filled/16.min.js";import u from"./date-picker.scss.min.js";import{carbonElement as v}from"../../globals/decorators/carbon-element.min.js";import{FORM_ELEMENT_COLOR_SCHEME as _}from"../../globals/shared-enums.min.js";import{INPUT_SIZE as b}from"../text-input/defs.min.js";let $=class extends(p(o)){constructor(){super(...arguments),this._hasAILabel=!1,this._hasHelperText=!1,this.colorScheme=_.REGULAR,this.disabled=!1,this.hideLabel=!1,this.invalid=!1,this.invalidText="",this.kind=c.SIMPLE,this.readonly=!1,this.required=!1,this.short=!1,this.size=b.MEDIUM,this.warn=!1,this.warnText=""}_handleAILabelSlotChange({target:e}){const t=e.assignedNodes().filter((e=>void 0!==e.matches&&(e.matches(this.constructor.aiLabelItem)||e.matches(this.constructor.slugItem))));this._hasAILabel=Boolean(t),t[0].setAttribute("size","mini"),this.requestUpdate()}_handleClickWrapper(e){e.target===this._iconNode&&this.input.focus()}_handleInput({target:e}){const{value:t}=e;this.value=t}_renderIcon(){return this.kind===c.SIMPLE?void 0:s({class:`${d}--date-picker__icon`,role:"img",children:[i` <title>Open calendar</title> `]})}_handleSlotChange({target:e}){if(!e.name){const t=e.assignedNodes().some((e=>e.nodeType!==Node.TEXT_NODE||e.textContent.trim()));this._hasHelperText=t}}render(){const e=this.constructor,{disabled:o,_hasHelperText:l,hideLabel:a,invalid:r,invalidText:s,labelText:p,pattern:c=e.defaultPattern,placeholder:u,readonly:v,size:_,type:b=e.defaultType,value:$,warn:f,warnText:y,_handleClickWrapper:g,_handleInput:x,_hasAILabel:k}=this,w=m({class:`${d}--date-picker__icon ${d}--date-picker__icon--invalid`}),j=h({class:`${d}--date-picker__icon ${d}--date-picker__icon--warn`}),I={invalid:!v&&r,warn:!v&&!r&&f,"slot-name":"","slot-text":"",icon:null};I.invalid?(I.icon=w,I["slot-name"]="invalid-text",I["slot-text"]=s):I.warn&&(I.icon=j,I["slot-name"]="warn-text",I["slot-text"]=y);const L=t({[`${d}--label`]:!0,[`${d}--visually-hidden`]:a,[`${d}--label--disabled`]:o}),T=t({[`${d}--date-picker__input`]:!0,[`${d}--date-picker__input--invalid`]:I.invalid,[`${d}--date-picker__input--warn`]:I.warn,[`${d}--date-picker__input--${_}`]:_,[`${d}--date-picker__input--decorator`]:k}),S=t({[`${d}--date-picker-input__wrapper`]:!0,[`${d}--date-picker-input__wrapper--invalid`]:I.invalid,[`${d}--date-picker-input__wrapper--warn`]:I.warn}),A=t({[`${d}--form__helper-text`]:!0,[`${d}--form__helper-text--disabled`]:o});return i`
      <label for="input" class="${L}">
        <slot name="label-text">${p}</slot>
      </label>
      <div class="${S}" @click="${g}">
        <span>
          <input
            id="input"
            type="${b}"
            class="${T}"
            ?disabled="${o}"
            pattern="${c}"
            placeholder="${n(u)}"
            .value="${n($)}"
            ?data-invalid="${r}"
            @input="${x}"
            ?readonly="${v}" />
          ${I.icon||this._renderIcon()}
          <slot
            name="ai-label"
            @slotchange="${this._handleAILabelSlotChange}"></slot>
          <slot
            name="slug"
            @slotchange="${this._handleAILabelSlotChange}"></slot>
        </span>
      </div>
      <div
        class="${d}--form-requirement"
        ?hidden="${!I.invalid&&!I.warn}">
        <slot name="${I["slot-name"]}">
          ${I["slot-text"]}
        </slot>
      </div>
      <div ?hidden="${l}" class="${A}">
        <slot name="helper-text" @slotchange="${this._handleSlotChange}"></slot>
      </div>
    `}updated(){var e,t,i,o,l;this.toggleAttribute("ai-label",this._hasAILabel);const a=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("slot[name='ai-label']");a?null==a||a.classList.toggle(`${d}--slug--revert`,null===(t=this.querySelector(`${d}-ai-label`))||void 0===t?void 0:t.hasAttribute("revert-active")):null===(o=null===(i=this.shadowRoot)||void 0===i?void 0:i.querySelector("slot[name='slug']"))||void 0===o||o.classList.toggle(`${d}--slug--revert`,null===(l=this.querySelector(`${d}-slug`))||void 0===l?void 0:l.hasAttribute("revert-active"))}static get selectorParent(){return`${d}-date-picker`}static get slugItem(){return`${d}-slug`}static get aiLabelItem(){return`${d}-ai-label`}};$.defaultPattern="\\d{1,2}\\/\\d{1,2}\\/\\d{4}",$.defaultType="text",$.shadowRootOptions=Object.assign(Object.assign({},o.shadowRootOptions),{delegatesFocus:!0}),$.styles=u,e([r(`.${d}--date-picker__icon`)],$.prototype,"_iconNode",void 0),e([a()],$.prototype,"_hasHelperText",void 0),e([r("input")],$.prototype,"input",void 0),e([l({attribute:"color-scheme",reflect:!0})],$.prototype,"colorScheme",void 0),e([l({type:Boolean,reflect:!0})],$.prototype,"disabled",void 0),e([l({type:Boolean,reflect:!0,attribute:"hide-label"})],$.prototype,"hideLabel",void 0),e([l({type:Boolean,reflect:!0})],$.prototype,"invalid",void 0),e([l({attribute:"invalid-text"})],$.prototype,"invalidText",void 0),e([l({reflect:!0})],$.prototype,"kind",void 0),e([l({attribute:"label-text"})],$.prototype,"labelText",void 0),e([l()],$.prototype,"pattern",void 0),e([l()],$.prototype,"placeholder",void 0),e([l({type:Boolean,reflect:!0})],$.prototype,"readonly",void 0),e([l({type:Boolean,reflect:!0})],$.prototype,"required",void 0),e([l({type:Boolean,reflect:!0})],$.prototype,"short",void 0),e([l({attribute:"size",reflect:!0})],$.prototype,"size",void 0),e([l()],$.prototype,"type",void 0),e([l()],$.prototype,"value",void 0),e([l({type:Boolean,reflect:!0})],$.prototype,"warn",void 0),e([l({attribute:"warn-text"})],$.prototype,"warnText",void 0),$=e([v(`${d}-date-picker-input`)],$);var f=$;export{_ as DATE_PICKER_INPUT_COLOR_SCHEME,c as DATE_PICKER_INPUT_KIND,f as default};
