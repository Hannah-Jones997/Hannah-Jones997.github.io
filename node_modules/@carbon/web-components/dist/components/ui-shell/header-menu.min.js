/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as e}from"../../node_modules/tslib/tslib.es6.min.js";import{ifDefined as t}from"../../node_modules/lit-html/directives/if-defined.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{html as i}from"../../node_modules/lit-html/lit-html.min.js";import{LitElement as o}from"../../node_modules/lit-element/lit-element.min.js";import{property as r}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{query as s}from"../../node_modules/@lit/reactive-element/decorators/query.min.js";import{classMap as n}from"../../node_modules/lit-html/directives/class-map.min.js";import l from"../../packages/icons/lib/chevron--down/16.min.js";import{prefix as a}from"../../globals/settings.min.js";import m from"../../globals/mixins/focus.min.js";import d from"../../globals/mixins/host-listener.min.js";import c from"../../globals/decorators/host-listener.min.js";import{forEach as p}from"../../globals/internal/collection-helpers.min.js";import h from"./header.scss.min.js";import{carbonElement as u}from"../../globals/decorators/carbon-element.min.js";let g=class extends(d(m(o))){constructor(){super(...arguments),this._hasActiveChildren=!1,this.expanded=!1,this.isActive=!1,this.triggerContent=""}_handleClick(){this._handleUserInitiatedToggle()}_handleKeydownTrigger({key:e}){"Esc"!==e&&"Escape"!==e||this._handleUserInitiatedToggle(!1)}_handleUserInitiatedToggle(e=!this.expanded){this.expanded=e,e||this._topMenuItem.focus()}_handleBlur({relatedTarget:e}){this.contains(e)||(this.expanded=!1)}connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","listitem");const{selectorItem:e}=this.constructor;p(this.querySelectorAll(e),(e=>{!0===e.isActive&&(this._hasActiveChildren=!0)})),super.connectedCallback()}updated(e){if(e.has("expanded")){const{selectorItem:e}=this.constructor,{expanded:t}=this;p(this.querySelectorAll(e),(e=>{e.tabIndex=t?0:-1}))}}render(){const{expanded:e,isActive:o,triggerContent:r,menuLabel:s,_hasActiveChildren:m,_handleClick:d}=this,c=n({[`${a}--header__menu-item`]:!0,[`${a}--header__menu-title`]:!0,[`${a}--header__menu-item--current`]:o||m&&!e});return i`
      <a
        part="trigger"
        role="button"
        tabindex="0"
        class="${c}"
        href="javascript:void 0"
        aria-haspopup="menu"
        aria-expanded="${String(Boolean(e))}"
        @click=${d}>
        ${r}${l({part:"trigger-icon",class:`${a}--header__menu-arrow`})}
      </a>
      <ul
        part="menu-body"
        class="${a}--header__menu"
        aria-label="${t(s)}">
        <slot></slot>
      </ul>
    `}static get selectorItem(){return`${a}-header-menu-item`}};g.shadowRootOptions=Object.assign(Object.assign({},o.shadowRootOptions),{delegatesFocus:!0}),g.styles=h,e([s('[part="trigger"]')],g.prototype,"_topMenuItem",void 0),e([c("keydown")],g.prototype,"_handleKeydownTrigger",null),e([c("focusout")],g.prototype,"_handleBlur",null),e([r({type:Boolean,reflect:!0})],g.prototype,"expanded",void 0),e([r({type:Boolean,attribute:"is-active",reflect:!0})],g.prototype,"isActive",void 0),e([r({attribute:"trigger-content"})],g.prototype,"triggerContent",void 0),e([r({attribute:"menu-label"})],g.prototype,"menuLabel",void 0),g=e([u(`${a}-header-menu`)],g);
