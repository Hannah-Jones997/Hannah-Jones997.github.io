/**
 * Copyright IBM Corp. 2019, 2020
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */
/**
 * @license
 * 
 * This bundle contains the following third-party dependencies:
 * 
 * Also refer to the following links for the license of other third-party dependencies:
 * 
 * https://www.npmjs.com/package/tslib
 * https://www.npmjs.com/package/lit
 * https://www.npmjs.com/package/@lit/context
 * https://www.npmjs.com/package/lodash-es
 * https://www.npmjs.com/package/@floating-ui/dom
 * https://www.npmjs.com/package/flatpickr
 * https://www.npmjs.com/package/lit-html
 * https://www.npmjs.com/package/lit-element
 * https://www.npmjs.com/package/@lit/reactive-element
 * https://www.npmjs.com/package/@floating-ui/core
 * https://www.npmjs.com/package/@floating-ui/utils
 */

import{__decorate as e}from"../../node_modules/tslib/tslib.es6.min.js";import"../../node_modules/@lit/reactive-element/reactive-element.min.js";import{html as t}from"../../node_modules/lit-html/lit-html.min.js";import{LitElement as s}from"../../node_modules/lit-element/lit-element.min.js";import{property as o}from"../../node_modules/@lit/reactive-element/decorators/property.min.js";import{prefix as r}from"../../globals/settings.min.js";import{indexOf as l,forEach as i}from"../../globals/internal/collection-helpers.min.js";import{CONTENT_SWITCHER_SIZE as c,NAVIGATION_DIRECTION as n}from"./defs.min.js";import h from"./content-switcher.scss.min.js";import{carbonElement as m}from"../../globals/decorators/carbon-element.min.js";let a=class extends s{constructor(){super(...arguments),this.value="",this.size=c.REGULAR,this.iconOnly=!1}_handleHover({target:e,type:t}){const{selectorItem:s}=this.constructor,o=this.querySelectorAll(s),r="mouseover"!==t?-1:l(o,e.closest(s)),c=r<0?r:r+1;i(this.querySelectorAll(s),((e,t)=>{e.hideDivider=t===c}));const{selectorItemSelected:n}=this.constructor,h=this.querySelector(n);this._getNextItem(h,1).hideDivider=!0}_getCurrentItem(e){var t;const s=this.querySelectorAll(this.constructor.selectorItemEnabled),{selectorItem:o}=this.constructor,r=e.closest(o);return null!==(t=s[l(s,r)])&&void 0!==t?t:null}_getNextItem(e,t){const s=this.querySelectorAll(this.constructor.selectorItemEnabled),o=l(s,e),r=(i=o+t,c=s.length,i<0?c-1:i>=c?0:i);var i,c;return r===o?null:s[r]}_handleClick({target:e}){const t=this._getCurrentItem(e);this._handleUserInitiatedSelectItem(t)}_handleKeydown({key:e}){e in n&&this._navigate(n[e])}_handleUserInitiatedSelectItem(e){if(!e.disabled&&e.value!==this.value){const t={bubbles:!0,composed:!0,detail:{item:e}},s=this.constructor,o=new CustomEvent(s.eventBeforeSelect,Object.assign(Object.assign({},t),{cancelable:!0}));if(this.dispatchEvent(o)){this._selectionDidChange(e);const o=new CustomEvent(s.eventSelect,t);this.dispatchEvent(o)}}}_navigate(e){const{selectorItemSelected:t}=this.constructor,s=this._getNextItem(this.querySelector(t),e);s&&(this._handleUserInitiatedSelectItem(s),this.requestUpdate())}_selectionDidChange(e){this.value=e.value,i(this.querySelectorAll(this.constructor.selectorItemSelected),(e=>{e.selected=!1})),e.selected=!0,Promise.resolve().then((()=>{e.focus();const{selectorItem:t}=this.constructor,s=this.querySelectorAll(t),o=l(s,e.closest(t)),r=o<0?o:o+1;i(this.querySelectorAll(t),((e,t)=>{e.hideDivider=t===r}))}))}shouldUpdate(e){if(e.has("value")){const{selectorItem:e}=this.constructor;i(this.querySelectorAll(e),(e=>{e.selected=e.value===this.value}))}const{selectorIconItem:t}=this.constructor;return this.querySelector(t)&&(this.iconOnly=!0),!0}_handleSlotchange(){const{selectorItemSelected:e}=this.constructor,t=this.querySelector(e);this._getNextItem(t,1).hideDivider=!0}static get selectorItem(){return`${r}-content-switcher-item`}static get selectorIconItem(){return`${r}-content-switcher-item[icon]`}static get selectorItemEnabled(){return`${r}-content-switcher-item:not([disabled])`}static get selectorItemSelected(){return`${r}-content-switcher-item[selected]`}static get eventBeforeSelect(){return`${r}-content-switcher-beingselected`}static get eventSelect(){return`${r}-content-switcher-selected`}render(){const{_handleHover:e,_handleKeydown:s,_handleSlotchange:o}=this;return t`
      <slot
        @click="${this._handleClick}"
        @keydown="${s}"
        @mouseover="${e}"
        @mouseout="${e}"
        @slotchange=${o}></slot>
    `}};a.styles=h,e([o({reflect:!0})],a.prototype,"value",void 0),e([o({reflect:!0})],a.prototype,"size",void 0),e([o({type:Boolean,reflect:!0,attribute:"icon"})],a.prototype,"iconOnly",void 0),a=e([m(`${r}-content-switcher`)],a);var d=a;export{c as CONTENT_SWITCHER_SIZE,n as NAVIGATION_DIRECTION,d as default};
